<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>conf.py - PyPlate</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">PyPlate</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">API</a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Bin</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../bin/pybaker/" class="dropdown-item">pybaker.py</a>
</li>
            
<li>
    <a href="../../bin/pymaker/" class="dropdown-item">pymaker.py</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Conf</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">conf.py</a>
</li>
            
<li>
    <a href="../mkdocs/" class="dropdown-item">mkdocs.py</a>
</li>
            
<li>
    <a href="../pdoc/" class="dropdown-item">pdoc.py</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Install</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../install/install/" class="dropdown-item">install.py</a>
</li>
            
<li>
    <a href="../../install/uninstall/" class="dropdown-item">uninstall.py</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Src</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../src/pybaker/" class="dropdown-item">pybaker.py</a>
</li>
            
<li>
    <a href="../../src/pymaker/" class="dropdown-item">pymaker.py</a>
</li>
            
<li>
    <a href="../../src/pyplate/" class="dropdown-item">pyplate.py</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../bin/pymaker/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../mkdocs/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#confpy" class="nav-link">conf.py</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf" class="nav-link">conf</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf.do_after_dist" class="nav-link">do_after_dist</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf.do_after_fix" class="nav-link">do_after_fix</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf.do_after_template" class="nav-link">do_after_template</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf.do_before_dist" class="nav-link">do_before_dist</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf.do_before_fix" class="nav-link">do_before_fix</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conf.conf.do_before_template" class="nav-link">do_before_template</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="confpy">conf.py</h1>


<div class="doc doc-object doc-module">



<a id="conf.conf"></a>
    <div class="doc doc-contents first">

        <p>This module separates out the constants from pymaker.py. It also includes hook
functions to extend the functionality of pymaker.py and pybaker.py.
This file, and the template folder, are the main ways to customize PyPlate.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="conf.conf.do_after_dist" class="doc doc-heading">
            <code class="highlight language-python">do_after_dist(dir_prj, dict_prv, _dict_pub, dict_dbg)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Do any work after making dist</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_prj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root of the new project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_prv</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing private pyplate data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_pub</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing public project data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_dbg</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the current session's debug</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Do any work on the dist folder after it is created. This method is called
after _do_dist. Currently, this method purges any "ABOUT" file used as
placeholders for github syncing. It also tars the source folder if it is a
package, making for one (or two) less steps in the user's install process.</p>


            <details class="quote">
              <summary>Source code in <code>conf/conf.py</code></summary>
              <pre class="highlight"><code class="language-python">def do_after_dist(dir_prj, dict_prv, _dict_pub, dict_dbg):
    """
    Do any work after making dist

    Args:
        dir_prj: The root of the new project
        dict_prv: The dictionary containing private pyplate data
        dict_pub: The dictionary containing public project data
        dict_dbg: The dictionary containing the current session's debug
        settings

    Do any work on the dist folder after it is created. This method is called
    after _do_dist. Currently, this method purges any "ABOUT" file used as
    placeholders for github syncing. It also tars the source folder if it is a
    package, making for one (or two) less steps in the user's install process.
    """

    # get dist dir for all operations
    dist = Path(dir_prj) / S_DIR_DIST
    name_fmt = dict_prv[S_KEY_PRV_PRJ]["__PP_DIST_DIR__"]
    p_dist = dist / name_fmt

    # --------------------------------------------------------------------------
    # move some files around between end of dist and start of install

    # get project type
    prj_type = dict_prv[S_KEY_PRV_PRJ]["__PP_TYPE_PRJ__"]

    if prj_type in L_APP_INSTALL:
        # move install.py to above assets
        file_inst = p_dist / S_DIR_ASSETS / S_DIR_INSTALL / S_FILE_INST_PY
        if file_inst.exists():
            shutil.move(file_inst, p_dist)

        # move uninstall.py to top of assets
        file_uninst = p_dist / S_DIR_ASSETS / S_DIR_INSTALL / S_FILE_UNINST_PY
        if file_uninst.exists():
            dest = p_dist / S_DIR_ASSETS
            shutil.move(file_uninst, dest)

    # --------------------------------------------------------------------------
    # remove all "ABOUT" files

    # print info
    print(S_ACTION_PURGE, end="", flush=True)

    # first purge all dummy files
    for root, _root_dirs, root_files in p_dist.walk():

        # convert files into Paths
        files = [root / f for f in root_files]

        # for each file item
        for item in files:

            # if it is in purge list, delete it
            if item.name in L_PURGE_FILES:
                item.unlink()

    # print info
    print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # compress dist

    # print info
    print(S_ACTION_COMPRESS, end="", flush=True)

    # get prj type
    name_small = dict_prv[S_KEY_PRV_PRJ]["__PP_NAME_PRJ_SMALL__"]

    # remove ext from bin file
    old_bin = (
        p_dist / S_DIR_ASSETS / S_DIR_BIN / f"{name_small}{S_DIST_REMOVE}"
    )
    new_bin = p_dist / S_DIR_ASSETS / S_DIR_BIN / f"{name_small}"
    if old_bin.exists():
        old_bin.rename(new_bin)

    # now do normal dist tar
    in_dir = p_dist
    out_file = Path(S_DIR_DIST) / f"{in_dir}{S_DIST_EXT}"
    with tarfile.open(out_file, mode=S_DIST_MODE) as compressed:
        compressed.add(in_dir, arcname=Path(in_dir).name)

    # print info
    print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # delete the origin dir, if key set

    # if debug key set
    if dict_dbg[S_KEY_DBG_DIST]:

        # print info
        print(S_ACTION_REM_DIST, end="", flush=True)

        # get dist dir for all operations
        dist = Path(dir_prj) / S_DIR_DIST
        name_fmt = dict_prv[S_KEY_PRV_PRJ]["__PP_DIST_DIR__"]
        p_dist = dist / name_fmt

        # delete folder
        shutil.rmtree(p_dist)

        # show info
        print(S_ACTION_DONE)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="conf.conf.do_after_fix" class="doc doc-heading">
            <code class="highlight language-python">do_after_fix(dir_prj, dict_prv, dict_pub, dict_dbg)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Do any work after fix</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_prj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root of the new project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_prv</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing private pyplate data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_pub</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing public project data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_dbg</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the current session's debug</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Do any work after fix.</p>
<p>This function is called by both PyMaker and PyBaker.</p>
<p>This method is called just after _do_fix, after all files have been
modified.</p>
<p>It is mostly used to update metadata once all the normal fixes have been
applied.</p>


            <details class="quote">
              <summary>Source code in <code>conf/conf.py</code></summary>
              <pre class="highlight"><code class="language-python">def do_after_fix(dir_prj, dict_prv, dict_pub, dict_dbg):
    """
    Do any work after fix

    Args:
        dir_prj: The root of the new project
        dict_prv: The dictionary containing private pyplate data
        dict_pub: The dictionary containing public project data
        dict_dbg: The dictionary containing the current session's debug
        settings

    Do any work after fix.\n
    This function is called by both PyMaker and PyBaker.\n
    This method is called just after _do_fix, after all files have been
    modified.\n
    It is mostly used to update metadata once all the normal fixes have been
    applied.
    """

    # get project type
    prj_type = dict_prv[S_KEY_PRV_PRJ]["__PP_TYPE_PRJ__"]

    # --------------------------------------------------------------------------
    # metadata

    # NB: this is an example of how to use the blacklist filter in your own
    # customized fix routine

    # print info
    print(S_ACTION_META, end="", flush=True)

    # NB: this function uses the blacklist to filter files at the very end of
    # the fix process. at this point you can assume ALL dunders in ALL eligible
    # files have been fixed, as well as paths/filenames. also dict_pub and
    # dict_prv have been undunderized
    dict_bl = dict_pub[S_KEY_PUB_BL]

    # just shorten the names
    skip_all = dict_bl[S_KEY_SKIP_ALL]
    skip_contents = dict_bl[S_KEY_SKIP_CONTENTS]

    # --------------------------------------------------------------------------
    # do the fixes

    # NB: root is a full path, dirs and files are relative to root
    for root, root_dirs, root_files in dir_prj.walk():

        # handle dirs in skip_all
        if root in skip_all:
            # NB: don't recurse into subfolders
            root_dirs.clear()
            continue

        # convert files into Paths
        files = [root / f for f in root_files]

        # for each file item
        for item in files:

            # handle files in skip_all
            if item in skip_all:
                continue

            # handle dirs/files in skip_contents
            if not root in skip_contents and not item in skip_contents:

                # fix content with appropriate dict
                _fix_meta(item, dict_prv, dict_pub)

    # print done
    print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # readme chop section

    path_readme = dir_prj / D_PRV_ALL["__PP_README_FILE__"]
    if path_readme.exists():

        print(S_ACTION_README, end="", flush=True)

        # the whole text of the file
        text = ""

        # open and read whole file
        with open(path_readme, "r", encoding=S_ENCODING) as a_file:
            text = a_file.read()

        # find the remove blocks (opposite of prj type)
        if prj_type in L_APP_INSTALL:
            str_pattern = S_RM_PKG
        else:
            str_pattern = S_RM_APP

        # replace block with empty string (equiv to deleting it)
        # NB: need S flag to make dot match newline
        text = re.sub(str_pattern, "", text, flags=re.S)

        # save file
        with open(path_readme, "w", encoding=S_ENCODING) as a_file:
            a_file.write(text)

        # show info
        print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # i18n

    # path to desktop template
    path_dsk_tmp = dir_prj / S_FILE_DSK_TMP
    # path to desktop output
    path_dsk_out = dir_prj / dict_prv[S_KEY_PRV_PRJ]["__PP_FILE_DESK__"]

    # if i18n flag is set
    if dict_dbg[S_KEY_DBG_I18N]:

        # print info
        print(S_ACTION_I18N, end="", flush=True)

        # ----------------------------------------------------------------------
        # do bulk of i18n

        # create CNPotPy object
        potpy = CNPotPy(
            # header
            str_domain=dict_prv[S_KEY_PRV_PRJ]["__PP_NAME_PRJ_SMALL__"],
            str_version=dict_prv[S_KEY_PRV_PRJ]["__PP_VER_MMR__"],
            str_author=dict_prv[S_KEY_PRV_ALL]["__PP_AUTHOR__"],
            str_email=dict_prv[S_KEY_PRV_ALL]["__PP_EMAIL__"],
            # base prj dir
            dir_prj=dir_prj,
            # in
            list_src=dict_pub[S_KEY_PUB_I18N][S_KEY_PUB_I18N_SRC],
            # out
            dir_pot=S_PATH_POT,
            dir_po=S_PATH_PO,
            dir_locale=S_PATH_LOCALE,
            # optional in
            str_tag=S_I18N_TAG,
            dict_clangs=dict_pub[S_KEY_PUB_I18N][S_KEY_PUB_I18N_CLANGS],
            dict_no_ext=dict_pub[S_KEY_PUB_I18N][S_KEY_PUB_I18N_NO_EXT],
            list_wlangs=dict_pub[S_KEY_PUB_I18N][S_KEY_PUB_I18N_WLANGS],
            charset=dict_pub[S_KEY_PUB_I18N][S_KEY_PUB_I18N_CHAR],
            location=False,
        )

        # make .pot, .po, and .mo files
        potpy.main()

        # ----------------------------------------------------------------------
        # do .desktop i18n/version

        # check if we want template
        if prj_type in L_MAKE_DESK and not path_dsk_tmp.exists():

            # we want template, but does not exist
            print("\n" + S_ERR_DESK_NO_TEMP.format(path_dsk_tmp, path_dsk_out))
        else:
            # do the thing
            potpy.make_desktop(path_dsk_tmp, path_dsk_out)

        # fix version in .po files (not always recreated by pybaker)
        path_po = dir_prj / S_DIR_I18N / S_DIR_PO
        for root, root_dirs, root_files in path_po.walk():
            files = [root / file for file in root_files]
            files = [
                file for file in files if PP.is_path_in_list(file, L_EXT_PO)
            ]
            for item in files:

                # get sub-dicts we need
                dict_prv_prj = dict_prv[S_KEY_PRV_PRJ]

                # default text if we can't open file
                text = ""

                # open file and get contents
                with open(item, "r", encoding=S_ENCODING) as a_file:
                    text = a_file.read()

                # replace version
                str_pattern = S_PO_VER_SCH
                pp_version = dict_prv_prj["__PP_VER_MMR__"]
                str_rep = S_PO_VER_REP.format(pp_version)
                text = re.sub(str_pattern, str_rep, text, flags=re.M | re.S)

                # save file
                with open(item, "w", encoding=S_ENCODING) as a_file:
                    a_file.write(text)

        # ----------------------------------------------------------------------
        # we are done
        print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # tree
    # NB: run last so it includes .git and .venv folders
    # NB: this will wipe out all previous checks (maybe good?)

    # if tree flag is set
    if dict_dbg[S_KEY_DBG_TREE]:

        # print info
        print(S_ACTION_TREE, end="", flush=True)

        # get path to tree
        file_tree = dir_prj / S_TREE_FILE

        # create the file so it includes itself
        with open(file_tree, "w", encoding=S_ENCODING) as a_file:
            a_file.write("")

        # create tree object and call
        tree_obj = CNTree(
            str(dir_prj),
            filter_list=dict_pub[S_KEY_PUB_BL][S_KEY_SKIP_TREE],
            dir_format=S_TREE_DIR_FORMAT,
            file_format=S_TREE_FILE_FORMAT,
        )
        tree_str = tree_obj.main()

        # write to file
        with open(file_tree, "w", encoding=S_ENCODING) as a_file:
            a_file.write(tree_str)

        # ----------------------------------------------------------------------
        # we are done
        print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # fix po files outside blacklist

    # print info
    print(S_ACTION_PO, end="", flush=True)

    # get i18n path
    path = dir_prj / S_DIR_I18N

    # get sub-dicts we need
    dict_prv_prj = dict_prv[S_KEY_PRV_PRJ]

    for root, root_dirs, root_files in path.walk():

        root_files = [root / root_file for root_file in root_files]

        for root_file in root_files:

            # only fix po files
            # if not root_file.suffix.lower() == ".po":
            if not PP.is_path_in_list(root_file, L_EXT_PO):
                continue

            # default text if we can't open file
            text = ""

            # open file and get contents
            with open(root_file, "r", encoding=S_ENCODING) as a_file:
                text = a_file.read()

            # replace version
            str_pattern = S_PO_VER_SCH
            pp_version = dict_prv_prj["__PP_VER_MMR__"]
            str_rep = S_PO_VER_REP.format(pp_version)
            text = re.sub(str_pattern, str_rep, text, flags=re.M | re.S)

            # save file
            with open(root_file, "w", encoding=S_ENCODING) as a_file:
                a_file.write(text)

    # --------------------------------------------------------------------------
    # purge package dirs

    if prj_type in D_PURGE_DIRS:
        l_purge = D_PURGE_DIRS[prj_type]
        l_purge = [
            (
                Path(dir_prj) / item
                if not Path(item).is_absolute()
                else Path(item)
            )
            for item in l_purge
        ]
        for item in l_purge:
            if item.exists():
                shutil.rmtree(item)

    # print done
    print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # docs

    # if docs flag is set
    if dict_dbg[S_KEY_DBG_DOCS]:

        # get the doc tool from the project info
        # NB: doc_tool is the import file name
        str_doc_tool = dict_pub[S_KEY_PUB_DOCS][S_KEY_DOCS_TOOL]
        doc_tool = None
        if str_doc_tool == S_DOCS_PDOCS:
            doc_tool = pdoc
        elif str_doc_tool == S_DOCS_MKDOCS:
            doc_tool = mkdocs

        # if we found a tool
        if doc_tool:

            # print info
            print(S_ACTION_DOCS, end="", flush=True)

            # the command to run pdoc/mkdocs/...
            try:
                doc_tool.make_docs(
                    dir_prj, dict_prv, dict_pub, P_DIR_PP, P_DIR_PP_VENV
                )
                print(S_ACTION_DONE)
            except Exception as e:
                print(S_ACTION_FAIL)
                raise e</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="conf.conf.do_after_template" class="doc doc-heading">
            <code class="highlight language-python">do_after_template(dir_prj, dict_prv, _dict_pub, dict_dbg)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Do any work after template copy</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_prj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root of the new project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_prv</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing private pyplate data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_pub</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing public project data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_dbg</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the current session's debug</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Do any work after copying the template. This function is called after
_do_template, and before _do_before_fix.</p>
<p>Use this function to create any files that your project needs to be created
dynamically. You can also run code that is only called by PyMaker before
fixing, like chopping the readme file sections.</p>


            <details class="quote">
              <summary>Source code in <code>conf/conf.py</code></summary>
              <pre class="highlight"><code class="language-python">def do_after_template(dir_prj, dict_prv, _dict_pub, dict_dbg):
    """
    Do any work after template copy

    Args:
        dir_prj: The root of the new project
        dict_prv: The dictionary containing private pyplate data
        dict_pub: The dictionary containing public project data
        dict_dbg: The dictionary containing the current session's debug
        settings

    Do any work after copying the template. This function is called after
    _do_template, and before _do_before_fix.\n
    Use this function to create any files that your project needs to be created
    dynamically. You can also run code that is only called by PyMaker before
    fixing, like chopping the readme file sections.
    """

    # get project type
    prj_type = dict_prv[S_KEY_PRV_PRJ]["__PP_TYPE_PRJ__"]

    # --------------------------------------------------------------------------
    # venv

    # if venv flag is set
    if dict_dbg[S_KEY_DBG_VENV]:

        # venv only for certain project types
        if prj_type in L_MAKE_VENV:

            print(S_ACTION_VENV, end="", flush=True)

            # get name ov venv folder and reqs file
            dir_venv = dict_prv[S_KEY_PRV_PRJ]["__PP_NAME_VENV__"]
            file_reqs = dir_prj / S_FILE_REQS

            # do the thing with the thing
            cv = CNVenv(dir_prj, dir_venv)
            try:
                cv.create()
                if file_reqs.exists():
                    cv.install_reqs(file_reqs)
                print(S_ACTION_DONE)
            except Exception as e:
                print(S_ACTION_FAIL)
                print(S_MSG_NO_INTERNET)
                raise e
        else:
            # no venv, no reqs
            (Path(dir_prj) / S_FILE_REQS).unlink()

    # --------------------------------------------------------------------------
    # git

    # if git flag
    if dict_dbg[S_KEY_DBG_GIT]:

        # show info
        print(S_ACTION_GIT, end="", flush=True)

        # add git dir
        cmd = S_CMD_GIT_CREATE.format(dir_prj)
        F.sh(cmd, shell=True)

        # show info
        print(S_ACTION_DONE)

    # --------------------------------------------------------------------------
    # install/uninstall config files

    # if install flag is set
    if dict_dbg[S_KEY_DBG_INST]:

        # cli/gui
        if prj_type in L_APP_INSTALL:

            # show info
            print(S_ACTION_INST, end="", flush=True)

            # create a template install cfg file
            dict_inst = D_INSTALL[prj_type]

            # fix dunders in inst cfg file
            path_inst = dir_prj / S_PATH_INST_CFG
            F.save_dict(dict_inst, [path_inst])

            # create a template uninstall cfg file
            dict_uninst = D_UNINSTALL[prj_type]

            # fix dunders in uninst cfg file
            path_uninst = dir_prj / S_PATH_UNINST_CFG
            F.save_dict(dict_uninst, [path_uninst])

            # show info
            print(S_ACTION_DONE)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="conf.conf.do_before_dist" class="doc doc-heading">
            <code class="highlight language-python">do_before_dist(dir_prj, dict_prv, dict_pub, dict_dbg)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Do any work before making dist</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_prj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root of the new project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_prv</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing private pyplate data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_pub</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing public project data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_dbg</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the current session's debug</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Do any work on the dist folder before it is created. This method is called
after _do_after_fix, and before _do_dist.</p>


            <details class="quote">
              <summary>Source code in <code>conf/conf.py</code></summary>
              <pre class="highlight"><code class="language-python">def do_before_dist(dir_prj, dict_prv, dict_pub, dict_dbg):
    """
    Do any work before making dist

    Args:
        dir_prj: The root of the new project
        dict_prv: The dictionary containing private pyplate data
        dict_pub: The dictionary containing public project data
        dict_dbg: The dictionary containing the current session's debug
        settings

    Do any work on the dist folder before it is created. This method is called
    after _do_after_fix, and before _do_dist.
    """

    # get project type
    prj_type = dict_prv[S_KEY_PRV_PRJ]["__PP_TYPE_PRJ__"]

    # --------------------------------------------------------------------------
    # docs

    # if docs flag is set
    if dict_dbg[S_KEY_DBG_DOCS]:

        # get the doc tool from the project info
        # NB: doc_tool is the import file name
        str_doc_tool = dict_pub[S_KEY_PUB_DOCS][S_KEY_DOCS_TOOL]
        doc_tool = None
        if str_doc_tool == S_DOCS_MKDOCS:
            doc_tool = mkdocs

        # if we found a tool
        if doc_tool:

            # print info
            print(S_ACTION_DEPLOY_DOCS, end="", flush=True)

            # the command to run pdoc/mkdocs/...
            try:
                doc_tool.deploy_docs(
                    dir_prj, dict_prv, dict_pub, P_DIR_PP, P_DIR_PP_VENV
                )
                print(S_ACTION_DONE)
            except Exception as e:
                print(S_ACTION_FAIL)
                raise e

    # --------------------------------------------------------------------------
    # venv

    # if venv flag is set
    if dict_dbg[S_KEY_DBG_VENV]:

        # venv only for certain project types
        if prj_type in L_MAKE_VENV:

            # print info
            print(S_ACTION_FREEZE, end="", flush=True)

            # get name ov venv folder and reqs file
            dir_venv = dict_prv[S_KEY_PRV_PRJ]["__PP_NAME_VENV__"]
            file_reqs = dir_prj / S_FILE_REQS

            # do the thing with the thing
            cv = CNVenv(dir_prj, dir_venv)
            try:
                cv.freeze(file_reqs)
                print(S_ACTION_DONE)
            except Exception as e:
                print(S_ACTION_FAIL)
                raise e

    # --------------------------------------------------------------------------
    # purge package dirs

    # if project type in dict
    if prj_type in D_PURGE_DIRS:

        # get list and make items absolute
        l_purge = D_PURGE_DIRS[prj_type]
        l_purge = [Path(item) for item in l_purge]
        l_purge = [
            dir_prj / item if not item.is_absolute() else item
            for item in l_purge
        ]

        # purge dirs
        for item in l_purge:
            if item.exists() and item.is_dir():
                shutil.rmtree(item)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="conf.conf.do_before_fix" class="doc doc-heading">
            <code class="highlight language-python">do_before_fix(_dir_prj, dict_prv, dict_pub, _dict_dbg)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Do any work before fix</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_prj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root of the new project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_prv</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing private pyplate data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_pub</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing public project data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_dbg</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the current session's debug</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Do any work before fix.</p>
<p>This function is called by both PyMaker and PyBaker.</p>
<p>This method is called just before_do_fix, after all dunders have been
configured, but before any files have been modified.</p>
<p>It is mostly used to make final adjustments to the 'dict_prv' and
'dict_pub' dicts before any replacement occurs.</p>


            <details class="quote">
              <summary>Source code in <code>conf/conf.py</code></summary>
              <pre class="highlight"><code class="language-python">def do_before_fix(_dir_prj, dict_prv, dict_pub, _dict_dbg):
    """
    Do any work before fix

    Args:
        dir_prj: The root of the new project
        dict_prv: The dictionary containing private pyplate data
        dict_pub: The dictionary containing public project data
        dict_dbg: The dictionary containing the current session's debug
        settings

    Do any work before fix.\n
    This function is called by both PyMaker and PyBaker.\n
    This method is called just before_do_fix, after all dunders have been
    configured, but before any files have been modified.\n
    It is mostly used to make final adjustments to the 'dict_prv' and
    'dict_pub' dicts before any replacement occurs.
    """

    # --------------------------------------------------------------------------
    # these paths are formatted here because they are complex and may be
    # changed by dev

    # get sub-dicts we need
    dict_prv_all = dict_prv[S_KEY_PRV_ALL]
    dict_prv_prj = dict_prv[S_KEY_PRV_PRJ]
    dict_pub_meta = dict_pub[S_KEY_PUB_META]

    # get values after pymaker has set them
    name_prj_small = dict_prv_prj["__PP_NAME_PRJ_SMALL__"]

    # paths relative to the end user's (or dev's) useful folders
    usr_inst = f"{S_USR_SHARE}/{name_prj_small}"
    dict_prv_prj["__PP_USR_INST__"] = usr_inst

    # k/v to fix desktop
    name_prj_big = dict_prv_prj["__PP_NAME_PRJ_BIG__"]
    dict_prv_prj["__PP_FILE_DESK__"] = (
        f"{S_DIR_SRC}/{S_DIR_GUI}/{S_DIR_DESKTOP}/{name_prj_big}.desktop"
    )

    # app id for gui
    author = dict_prv_all["__PP_AUTHOR__"]
    dict_prv_prj["__PP_APP_ID__"] = S_APP_ID_FMT.format(author, name_prj_small)

    # --------------------------------------------------------------------------
    # version stuff

    # get base version
    ver_base = dict_pub_meta[S_KEY_META_VERSION]

    # set display of version
    dict_prv_prj["__PP_VER_DISP__"] = S_VER_DISP_FMT.format(ver_base)

    # semantic version with meta info
    str_sem = ver_base
    dict_prv_prj["__PP_VER_MMR__"] = str_sem

    # fix ver for dist filename
    ver_dist = str_sem

    # format dist dir name with prj and ver
    name_fmt = S_VER_DIST_FMT.format(name_prj_small, ver_dist)
    dict_prv_prj["__PP_DIST_DIR__"] = name_fmt

    # ----------------------------------------------------------------------
    # calculate current date
    # NB: this is the initial create date for all files in the template
    # new files added to the project will have their dates set to the date
    # when pybaker was last run

    # get current date and format it according to dev fmt
    now = datetime.now()
    fmt_date = S_DATE_FMT
    info_date = now.strftime(fmt_date)
    dict_prv_prj["__PP_DATE__"] = info_date

    # gui app/win replacements
    name_prj_pascal = dict_prv_prj["__PP_NAME_PRJ_PASCAL__"]
    name_sec_small = dict_prv_prj["__PP_NAME_SEC_SMALL__"]
    name_sec_pascal = dict_prv_prj["__PP_NAME_SEC_PASCAL__"]
    dict_prv_prj["__PP_FILE_APP__"] = S_APP_FILE_FMT.format(name_prj_small)
    dict_prv_prj["__PP_CLASS_APP__"] = S_APP_CLASS_FMT.format(name_prj_pascal)
    dict_prv_prj["__PP_FILE_WIN__"] = S_WIN_FILE_FMT.format(name_sec_small)
    dict_prv_prj["__PP_CLASS_WIN__"] = S_WIN_CLASS_FMT.format(name_sec_pascal)

    # various image files
    img_ext = (
        f".{S_IMG_EXT.lower()}"
        if not S_IMG_EXT.startswith(".")
        else S_IMG_EXT.lower()
    )
    dict_prv_prj["__PP_IMG_README__"] = (
        f"{S_DIR_IMAGES}/{name_prj_small}{img_ext}"
    )
    # NB: .desktop needs abs path to img
    dict_prv_prj["__PP_IMG_DESK__"] = (
        f"{usr_inst}/{S_DIR_IMAGES}/{name_prj_small}{img_ext}"
    )
    # NB: .ui files need rel path to img
    dict_prv_prj["__PP_IMG_DASH__"] = (
        f"{"../../.."}/{S_DIR_IMAGES}/{name_prj_small}{img_ext}"
    )
    dict_prv_prj["__PP_IMG_ABOUT__"] = (
        f"{"../../.."}/{S_DIR_IMAGES}/{name_prj_small}{img_ext}"
    )</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="conf.conf.do_before_template" class="doc doc-heading">
            <code class="highlight language-python">do_before_template(_dir_prj, _dict_prv, _dict_pub, _dict_dbg)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Do any work before template copy</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_prj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root of the new project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_prv</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing private pyplate data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_pub</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing public project data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_dbg</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the current session's debug</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Do any work before copying the template. This method is called just before
_do_template, before any files have been copied.</p>
<p>It is mostly used to make final adjustments to the 'dict_prv' and
'dict_pub' dicts before any copying occurs.</p>


            <details class="quote">
              <summary>Source code in <code>conf/conf.py</code></summary>
              <pre class="highlight"><code class="language-python">def do_before_template(_dir_prj, _dict_prv, _dict_pub, _dict_dbg):
    """
    Do any work before template copy

    Args:
        dir_prj: The root of the new project
        dict_prv: The dictionary containing private pyplate data
        dict_pub: The dictionary containing public project data
        dict_dbg: The dictionary containing the current session's debug
        settings

    Do any work before copying the template. This method is called just before
    _do_template, before any files have been copied.\n
    It is mostly used to make final adjustments to the 'dict_prv' and
    'dict_pub' dicts before any copying occurs.
    """</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
